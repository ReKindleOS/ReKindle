<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hangman</title>
    <style>
        /* SYSTEM 7 AESTHETICS */
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --border: 2px solid #000000;
            --shadow: 4px 4px 0px #000000;
            --stripe-pattern: repeating-linear-gradient(0deg, transparent, transparent 2px, #000 3px, #000 4px);
            --disabled-key: #e0e0e0;
        }

        body {
            image-rendering: -webkit-crisp-edges;
            image-rendering: -moz-crisp-edges;
            image-rendering: -o-crisp-edges;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            -ms-interpolation-mode: nearest-neighbor;
            background-repeat: repeat;
            background-position: top left;

            image-rendering: -webkit-optimize-contrast;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            background-repeat: repeat;
            background-position: top left;

            image-rendering: pixelated;
            image-rendering: crisp-edges;
            background-repeat: repeat;
            background-position: top left;

            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            height: 100vh;
            overflow: hidden;
            background-color: #e5e5e5;
            /* Default Background (Overridden by JS) */
            /* Background managed by settings */
            
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* FIX: Centers vertically */
            user-select: none;
            box-sizing: border-box;
        }

        /* WINDOW FRAME */
        .window {
            background: white;
            border: 2px solid black;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            height: fit-content; /* ADAPTIVE HEIGHT */
            max-height: 95vh;
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        /* TITLE BAR */
        .title-bar {
            height: 35px;
            border-bottom: 2px solid black;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 0 10px;
            position: relative;
            flex-shrink: 0;
        }

        .title-stripes {
            position: absolute;
            top: 4px; bottom: 4px; left: 4px; right: 4px;
            background-image: var(--stripe-pattern);
            z-index: 0;
        }

        .title-text {
            background: white;
            padding: 0 15px;
            font-weight: bold;
            z-index: 1;
            font-size: 1.1rem;
        }

        /* CLOSE BUTTON (HOME) */
        .close-box {
            position: absolute;
            left: 10px;
            width: 18px;
            height: 18px;
            border: 2px solid black;
            background: white;
            z-index: 2;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: sans-serif;
            font-size: 0.9rem;
            line-height: 1;
            box-shadow: 2px 2px 0 black;
        }

        .close-box:active {
            background: black;
            color: white;
            transform: translate(1px, 1px);
            box-shadow: none;
        }

        /* CONTROLS */
        .controls {
            position: absolute;
            right: 10px;
            z-index: 1;
            background: white;
            display: flex;
            gap: 10px;
        }

        .sys-btn {
            background: white;
            border: 2px solid black;
            padding: 4px 10px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 2px 2px 0 black;
            font-size: 0.8rem;
        }

        .sys-btn:active {
            background: black;
            color: white;
            transform: translate(2px, 2px);
            box-shadow: none;
        }

        /* WINDOW CONTENT */
        .window-content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* GAME AREA */
        #gallows-area {
            width: 200px;
            height: 220px;
            margin-bottom: 20px;
            position: relative;
        }

        svg {
            width: 100%;
            height: 100%;
            fill: none;
            stroke: black;
            stroke-width: 4;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Hidden parts */
        .part { display: none; }
        .part.visible { display: block; }

        /* WORD DISPLAY */
        #word-display {
            font-family: "Courier New", Courier, monospace;
            font-size: 2.5rem;
            font-weight: bold;
            letter-spacing: 5px;
            margin-bottom: 20px;
            text-align: center;
            min-height: 50px;
            word-wrap: break-word;
        }

        /* MESSAGE BAR */
        #message-bar {
            font-size: 1.2rem;
            font-weight: bold;
            height: 30px;
            text-align: center;
            margin-bottom: 10px;
        }

        /* KEYBOARD */
        #keyboard {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            max-width: 650px;
            margin-top: auto;
            padding-bottom: 10px;
        }

        .key-row {
            display: flex;
            justify-content: center;
            gap: 6px;
        }

        .key {
            font-family: sans-serif;
            font-weight: bold;
            font-size: 1.2rem;
            width: 40px;
            height: 50px;
            border: 2px solid black;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 4px;
            box-shadow: 2px 2px 0 #ccc;
        }

        .key:active {
            background: black;
            color: white;
            transform: translate(1px, 1px);
            box-shadow: none;
        }

        .key.used {
            background: var(--disabled-key);
            border-color: #999;
            color: #999;
            pointer-events: none;
            box-shadow: none;
        }

    </style>
    <script src="theme.js"></script>
</head>
<body>

    <div class="window">
        <div class="title-bar">
            <div class="title-stripes"></div>
            <!-- Home Button -->
            <div class="close-box" onclick="window.location.href='index'">X</div>
            
            <span class="title-text">Hangman</span>
            
            <div class="controls">
                <button class="sys-btn" onclick="initGame()">New Game</button>
            </div>
        </div>

        <div class="window-content">
            <div id="gallows-area">
                <svg viewBox="0 0 100 120">
                    <!-- Base Structure -->
                    <line x1="10" y1="110" x2="90" y2="110" /> <!-- Floor -->
                    <line x1="30" y1="110" x2="30" y2="10" />  <!-- Pole -->
                    <line x1="30" y1="10" x2="70" y2="10" />   <!-- Top -->
                    <line x1="70" y1="10" x2="70" y2="25" />   <!-- Rope -->
                    
                    <!-- The Man -->
                    <circle cx="70" cy="35" r="10" class="part" id="part-0" /> <!-- Head -->
                    <line x1="70" y1="45" x2="70" y2="80" class="part" id="part-1" /> <!-- Body -->
                    <line x1="70" y1="55" x2="50" y2="70" class="part" id="part-2" /> <!-- L Arm -->
                    <line x1="70" y1="55" x2="90" y2="70" class="part" id="part-3" /> <!-- R Arm -->
                    <line x1="70" y1="80" x2="55" y2="100" class="part" id="part-4" /> <!-- L Leg -->
                    <line x1="70" y1="80" x2="85" y2="100" class="part" id="part-5" /> <!-- R Leg -->
                </svg>
            </div>

            <div id="word-display">_ _ _ _ _</div>
            <div id="message-bar">Guess a letter</div>

            <div id="keyboard">
                <!-- Keys generated by JS -->
            </div>
        </div>
    </div>

    <script>
        // --- WORD LIST ---
        const WORDS = [
            "ACTION", "BASKET", "CIRCLE", "DOCTOR", "ENERGY", "FAMILY", "GARDEN", "HUNGRY",
            "ISLAND", "JUNGLE", "KNIGHT", "LAWYER", "MARKET", "NATURE", "ORANGE", "PENCIL",
            "QUICKLY", "ROCKET", "SILVER", "TRAVEL", "UNIQUE", "VALLEY", "WINDOW", "YELLOW",
            "ZEBRA", "BRIDGE", "CAMERA", "DESERT", "FOREST", "GUITAR", "HAMMER", "INSECT",
            "JACKET", "KITTEN", "LIZARD", "MUSEUM", "NAPKIN", "OXYGEN", "PLANET", "QUARTZ",
            "RABBIT", "SCHOOL", "TOMATO", "UMPIRE", "VIOLIN", "WINTER", "XRAY", "YOGURT",
            "ZOMBIE", "ANCHOR", "BANANA", "CACTUS"
        ];

        // --- STATE ---
        let currentWord = "";
        let guessedLetters = new Set();
        let mistakes = 0;
        const MAX_MISTAKES = 6;
        let isGameOver = false;

        // --- INIT ---
        window.onload = () => {
            loadWallpaper();
            initKeyboard();
            initGame();
        };


        function initGame() {
            // Reset State
            currentWord = WORDS[Math.floor(Math.random() * WORDS.length)];
            guessedLetters.clear();
            mistakes = 0;
            isGameOver = false;

            // Reset UI
            document.getElementById('message-bar').innerText = "Guess a letter";
            document.querySelectorAll('.part').forEach(el => el.classList.remove('visible'));
            
            // Reset Keyboard
            document.querySelectorAll('.key').forEach(btn => btn.classList.remove('used'));

            renderWord();
        }

        function initKeyboard() {
            const rows = [
                "QWERTYUIOP".split(""),
                "ASDFGHJKL".split(""),
                "ZXCVBNM".split("")
            ];
            
            const keyboard = document.getElementById('keyboard');
            keyboard.innerHTML = '';

            rows.forEach(rowKeys => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'key-row';
                
                rowKeys.forEach(char => {
                    const btn = document.createElement('div');
                    btn.className = 'key';
                    btn.innerText = char;
                    btn.id = `key-${char}`;
                    btn.onclick = () => handleGuess(char);
                    rowDiv.appendChild(btn);
                });
                
                keyboard.appendChild(rowDiv);
            });
        }

        // --- GAME LOGIC ---
        function handleGuess(char) {
            if (isGameOver || guessedLetters.has(char)) return;

            guessedLetters.add(char);
            document.getElementById(`key-${char}`).classList.add('used');

            if (currentWord.includes(char)) {
                renderWord();
                checkWin();
            } else {
                mistakes++;
                updateGallows();
                checkLoss();
            }
        }

        function renderWord() {
            const display = currentWord.split('').map(letter => 
                guessedLetters.has(letter) ? letter : "_"
            ).join(" ");
            
            document.getElementById('word-display').innerText = display;
        }

        function updateGallows() {
            if (mistakes > 0 && mistakes <= MAX_MISTAKES) {
                document.getElementById(`part-${mistakes - 1}`).classList.add('visible');
            }
        }

        function checkWin() {
            const isWon = currentWord.split('').every(l => guessedLetters.has(l));
            if (isWon) {
                document.getElementById('message-bar').innerText = "You Survived!";
                isGameOver = true;
            }
        }

        function checkLoss() {
            if (mistakes >= MAX_MISTAKES) {
                document.getElementById('message-bar').innerText = "Game Over: " + currentWord;
                // Reveal all parts
                for(let i=0; i<MAX_MISTAKES; i++) {
                    document.getElementById(`part-${i}`).classList.add('visible');
                }
                isGameOver = true;
            }
        }

    </script>

    <script>
        // Helper to sanitize background image URLs from localStorage
        function sanitizeBackgroundImage(imageString) {
            if (!imageString) return '';
            if (imageString.startsWith('url("data:image/png;base64,')) {
                return imageString;
            }
            if (imageString.startsWith('url("') && imageString.endsWith('")')) {
                const url = imageString.substring(5, imageString.length - 2);
                if ((url.startsWith('http://') || url.startsWith('https://') || url.startsWith('/')) && !url.includes('javascript:')) {
                    return imageString;
                }
            }
            return '';
        }

        
        loadWallpaper();

        function loadWallpaper() {
            const wallpaperImg = localStorage.getItem('rekindle_bg_image');
            const wallpaperSize = localStorage.getItem('rekindle_bg_size');
            if (wallpaperImg) {
                document.body.style.backgroundImage = wallpaperImg;
            }
            if (wallpaperSize) {
                document.body.style.backgroundSize = wallpaperSize;
            }
        }
    </script>
<script src="https://cdn.counter.dev/script.js" data-id="4e551911-0e5d-4c48-91a6-b828c3301675" data-utcoffset="11"></script>
</body>
</html>