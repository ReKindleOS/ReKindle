const ASCII_EMOJIS = {
    "ʘ‿ʘ": [
        { art: "\\˚ㄥ˚\\", name: "Quirky" },
        { art: "☁ ▅▒░☼‿☼░▒▅ ☁", name: "Sunrise" },
        { art: "ˁ˚ᴥ˚ˀ", name: "Bear Friend" },
        { art: "⎦˚◡˚⎣", name: "Boxy Smile" },
        { art: "<*_*>", name: "Starry Eyes" },
        { art: "(-(-_(-_-)_-)-)", name: "The Squad" },
        { art: "(✿ ♥‿♥)", name: "Lovely" },
        { art: "㋡", name: "Chill" },
        { art: "(⌒▽⌒)", name: "Joy" },
        { art: "(◔/‿\\◔)", name: "Derp Stare" },
        { art: "(⋗_⋖)", name: "Ouch" },
        { art: "ة_ة", name: "Dazed" },
        { art: "\\(^-^)/", name: "Yay" },
        { art: "◕_◕", name: "Puppy Eyes" },
        { art: "(っ◕‿◕)っ", name: "Gimme Hug" },
        { art: "( ͠° ͟ʖ ͡°)", name: "Suspicious" },
        { art: "ʘ‿ʘ", name: "Innocent Face" },
        { art: "(｡◕‿◕｡)", name: "Cute Big Eyes" },
        { art: "☜(⌒▽⌒)☞", name: "Excited" },
        { art: "ヽ(´▽`)/", name: "Happy" },
        { art: "ヽ(´ー｀)ノ", name: "Glory" },
        { art: "⊂(◉‿◉)つ", name: "Kirby" },
        { art: "(づ￣ ³￣)づ", name: "Hugger" },
        { art: "“ヽ(´▽｀)ノ”", name: "TGIF" },
        { art: "♥‿♥", name: "Love" },
        { art: "( ˘ ³˘)♥", name: "Kissing" },
        { art: "\\(ᵔᵕᵔ)/", name: "Happy Hug" },
        { art: "ᴖ̮ ̮ᴖ", name: "Resting Eyes" },
        { art: "-`ღ´-", name: "Love 2" }
    ],
    "ಠ_ಠ": [
        { art: "ಠ_ಠ", name: "Disapproval" },
        { art: "(╬ ಠ益ಠ)", name: "Angry" },
        { art: "ლ(ಠ益ಠლ)", name: "At What Cost" },
        { art: "ಠ‿ಠ", name: "Devious" },
        { art: "ಥ_ಥ", name: "Crying" },
        { art: "ಥ﹏ಥ", name: "Breakdown" },
        { art: "٩◔̯◔۶", name: "Disagree" },
        { art: "(´･_･`)", name: "Worried" },
        { art: "(ಥ⌣ಥ)", name: "Sad" },
        { art: "눈_눈", name: "Sleepy" },
        { art: "( ఠ ͟ʖ ఠ)", name: "Judging" },
        { art: "( ͡ಠ ʖ̯ ͡ಠ)", name: "Tired" },
        { art: "( ಠ ʖ̯ ಠ)", name: "Dislike" },
        { art: "(ᵟຶ︵ ᵟຶ)", name: "Sad Crying" }
    ],
    "(っ▀¯▀)つ": [
        { art: "¯\\_(ツ)_/¯", name: "Shrug" },
        { art: "( ͡° ͜ʖ ͡°)", name: "Lenny Face" },
        { art: "ᕙ(⇀‸↼‶)ᕗ", name: "Flexing" },
        { art: "┌(ㆆ㉨ㆆ)ʃ", name: "Dancing" },
        { art: "(•̀ᴗ•́)و ̑̑", name: "Winning" },
        { art: "(☞ﾟヮﾟ)☞", name: "Pointing" },
        { art: "(っ▀¯▀)つ", name: "Stunna Shades" },
        { art: "(∩｀-´)⊃━☆ﾟ.*･｡ﾟ", name: "Wizard" },
        { art: "(╯°□°）╯︵ ┻━┻", name: "Table Flip" },
        { art: "┬─┬﻿ ノ( ゜-゜ノ)", name: "Put Table Back" },
        { art: "┬─┬⃰͡ (ᵔᵕᵔ͜ )", name: "Tidy Table" },
        { art: "(ง'̀-'́)ง", name: "Fight" }
    ],
    "ʕ•ᴥ•ʔ": [
        { art: "ʕ•ᴥ•ʔ", name: "Cute Bear" },
        { art: "ʕᵔᴥᵔʔ", name: "Squinting Bear" },
        { art: "ʕ •`ᴥ•´ʔ", name: "GTFO Bear" },
        { art: "V•ᴥ•V", name: "Dog" },
        { art: "ฅ^•ﻌ•^ฅ", name: "Meow" },
        { art: "ʕ •́؈•̀ ₎", name: "Winnie" },
        { art: "{•̃_•̃}", name: "Robot" },
        { art: "(ᵔᴥᵔ)", name: "Seal" },
        { art: "[¬º-°]¬", name: "Zombie" },
        { art: "ƪ(ړײ)‎ƪ​​", name: "Creeper" },
    ],
    "⊙﹏⊙": [
        { art: "¯\\(°_o)/¯", name: "Meh" },
        { art: "⊙﹏⊙", name: "Discombobulated" },
        { art: "¯\\_(⊙︿⊙)_/¯", name: "Sad Confused" },
        { art: "¿ⓧ_ⓧﮌ", name: "Confused" },
        { art: "(⊙.☉)7", name: "Confused Scratch" },
        { art: "٩(๏_๏)۶", name: "Staring" },
        { art: "(⊙_◎)", name: "Zoned" },
        { art: "ミ●﹏☉ミ", name: "Crazy" },
        { art: "(Ծ‸ Ծ)", name: "Questionable" },
        { art: "⥀.⥀", name: "Eye Roll" },
        { art: "♨_♨", name: "Unseen" },
        { art: "(._.)", name: "Looking Down" }
    ]
};

// --- REACTION SVGS ---
// Simple SVG icons for chat reactions. Keys match reaction values stored in Firebase.
// BACKWARDS_COMPAT: Maps old text reactions to new SVG keys
var REACTION_SVGS = {
    'rekindle': '<svg viewBox="0 0 900 900" width="16" height="16" fill="currentColor"><g transform="translate(0,900) scale(0.1,-0.1)"><path d="M7600 7875 c-8 -2 -89 -8 -180 -15 -227 -15 -498 -49 -677 -85 -217 -44 -273 -57 -388 -90 -27 -8 -75 -21 -105 -30 -123 -35 -166 -48 -185 -56 -26 -10 -118 -47 -170 -66 -102 -39 -128 -50 -250 -110 -71 -35 -137 -68 -145 -73 -8 -5 -58 -35 -110 -65 -239 -139 -442 -309 -632 -527 -67 -78 -162 -207 -181 -248 -4 -8 -16 -28 -26 -45 -78 -121 -155 -289 -194 -420 -9 -27 -22 -72 -31 -100 -9 -27 -16 -59 -16 -70 0 -10 -6 -37 -14 -60 -8 -22 -22 -92 -32 -155 -26 -158 -26 -675 -1 -790 10 -41 17 -89 17 -107 0 -17 5 -44 11 -60 6 -15 14 -48 19 -73 7 -43 14 -74 47 -205 8 -33 21 -75 29 -93 18 -41 18 -67 0 -100 -18 -36 -60 -148 -76 -207 -5 -16 -18 -55 -30 -85 -12 -30 -26 -68 -30 -85 -5 -16 -18 -61 -30 -100 -11 -38 -25 -92 -30 -118 -5 -27 -12 -52 -14 -56 -7 -11 -37 -148 -45 -201 -7 -51 -28 -60 -48 -20 -7 14 -30 61 -52 105 -22 44 -53 108 -70 141 -27 56 -29 65 -19 100 8 26 12 142 12 339 0 334 -7 396 -70 595 -55 175 -81 234 -173 389 -133 224 -391 457 -647 584 -118 59 -233 107 -253 107 -9 0 -22 5 -28 11 -6 6 -26 14 -44 19 -19 5 -74 20 -124 33 -336 91 -802 128 -1228 97 -143 -10 -174 -22 -210 -80 -19 -31 -22 -48 -20 -140 2 -117 26 -318 49 -396 7 -28 14 -60 14 -71 0 -11 6 -39 14 -64 7 -24 21 -78 31 -119 21 -92 47 -177 75 -250 12 -30 26 -68 30 -84 5 -16 48 -106 94 -200 125 -252 251 -431 416 -596 102 -102 270 -228 370 -279 25 -12 64 -33 86 -45 23 -13 50 -26 60 -29 11 -3 46 -15 79 -27 246 -88 527 -122 812 -101 93 7 207 19 254 27 47 9 101 14 120 12 32 -3 37 -8 85 -106 49 -97 97 -208 131 -297 8 -22 19 -49 23 -60 11 -31 64 -250 91 -380 7 -38 14 -217 19 -495 4 -239 12 -480 19 -535 32 -269 45 -340 65 -368 67 -92 204 -89 261 5 24 40 24 116 0 282 -27 195 -16 424 31 611 18 72 81 270 94 293 5 10 27 55 49 102 57 120 77 153 155 260 75 102 179 210 267 276 127 96 314 164 452 164 271 0 475 -245 416 -497 -27 -116 -89 -197 -188 -248 -65 -33 -181 -36 -239 -6 -59 30 -122 109 -122 152 0 24 -35 87 -60 107 -85 70 -207 47 -246 -47 -48 -115 38 -312 185 -425 114 -88 222 -125 366 -125 193 -1 397 113 509 283 31 47 56 90 56 95 0 6 6 25 14 43 40 96 49 143 49 258 0 166 -42 296 -140 432 -37 51 -159 168 -176 168 -6 0 -18 6 -26 13 -19 16 -149 70 -211 87 -78 22 -282 24 -364 4 -150 -36 -265 -81 -361 -141 -11 -7 -27 -15 -35 -19 -26 -13 -164 -120 -206 -160 -22 -22 -65 -68 -95 -104 -30 -35 -59 -70 -66 -78 -7 -7 -27 -33 -44 -57 -18 -25 -37 -45 -42 -45 -18 0 2 187 34 315 6 22 14 63 18 90 5 28 14 73 21 100 39 158 42 169 84 315 23 79 82 256 106 320 12 30 25 66 29 80 l8 25 274 -3 c423 -5 680 18 914 83 28 7 79 21 115 30 36 10 82 23 103 31 99 37 124 47 152 59 62 27 241 117 270 135 17 11 36 23 44 27 77 37 278 199 411 333 79 78 290 346 290 367 0 3 12 22 28 42 33 44 49 70 61 97 5 11 28 51 50 88 23 36 41 70 41 74 0 3 14 36 31 72 40 83 50 107 89 205 17 44 37 94 44 110 21 48 37 97 46 135 5 19 18 67 29 105 12 39 25 88 31 110 5 22 13 58 19 80 5 22 16 74 25 115 8 41 22 109 30 150 9 41 16 86 16 99 0 13 7 63 15 110 34 200 45 366 45 668 0 334 -2 349 -63 390 -47 32 -132 49 -187 38z m-58 -335 c11 -32 -24 -587 -41 -655 -6 -22 -11 -56 -11 -75 0 -19 -6 -66 -14 -105 -8 -38 -22 -115 -31 -170 -9 -55 -23 -122 -30 -150 -8 -27 -16 -61 -19 -75 -2 -14 -9 -38 -14 -55 -6 -16 -17 -52 -25 -80 -41 -142 -52 -176 -79 -245 -44 -112 -50 -124 -122 -270 -70 -140 -73 -147 -118 -218 -16 -24 -28 -45 -28 -47 0 -10 -107 -155 -173 -233 -101 -122 -194 -211 -304 -295 -97 -73 -260 -175 -338 -211 -22 -11 -49 -24 -60 -29 -24 -12 -167 -65 -210 -77 -16 -5 -61 -18 -100 -30 -96 -28 -212 -49 -325 -61 -52 -5 -125 -13 -162 -19 -76 -11 -316 -13 -431 -4 -93 8 -94 11 -39 116 81 152 116 215 191 340 60 99 240 359 262 378 3 3 29 37 58 75 112 149 389 439 560 585 35 30 69 60 75 65 6 6 23 19 37 30 14 11 99 75 187 143 89 67 164 122 167 122 16 0 180 123 196 147 30 44 26 125 -8 169 -28 38 -89 74 -123 74 -30 0 -100 -38 -215 -115 -100 -68 -217 -150 -245 -172 -8 -7 -60 -47 -115 -90 -88 -68 -145 -117 -204 -173 -9 -9 -61 -56 -115 -105 -110 -100 -227 -225 -422 -454 -42 -49 -168 -217 -240 -321 -66 -93 -242 -383 -270 -443 -24 -51 -47 -45 -56 13 -41 261 -50 525 -22 715 28 199 55 320 90 403 8 18 14 40 14 50 0 9 7 26 15 36 8 11 15 26 15 33 0 16 91 203 120 248 11 17 23 37 27 45 4 8 47 69 96 134 106 141 219 255 354 358 93 71 230 168 238 168 2 0 36 19 77 43 40 24 98 55 128 69 181 84 211 98 219 98 5 0 42 14 82 31 95 40 130 53 204 74 33 10 75 24 93 31 18 8 40 14 50 14 9 0 34 6 57 14 48 17 149 39 270 61 50 9 122 22 160 30 136 27 251 44 335 51 47 3 112 9 145 14 91 11 183 11 187 0z m-5602 -1970 c153 -7 207 -14 365 -41 33 -6 80 -14 105 -18 44 -8 79 -16 190 -48 49 -14 250 -92 291 -113 105 -54 192 -107 234 -142 11 -9 43 -34 71 -56 62 -49 177 -177 232 -259 39 -59 102 -184 102 -202 0 -5 6 -22 14 -38 56 -112 95 -281 103 -454 6 -119 -3 -154 -28 -107 -32 62 -325 366 -474 493 -44 37 -91 77 -105 89 -68 58 -274 206 -287 206 -3 0 -22 13 -42 28 -20 16 -43 32 -51 35 -8 4 -28 16 -45 27 -16 11 -37 23 -45 27 -8 4 -35 19 -60 34 -106 64 -184 60 -241 -13 -26 -32 -30 -46 -30 -94 0 -70 29 -119 92 -152 24 -12 53 -28 64 -35 17 -11 57 -35 120 -74 11 -7 29 -17 40 -23 54 -28 280 -200 395 -301 76 -67 303 -294 358 -359 78 -90 180 -225 176 -232 -13 -21 -98 -31 -302 -35 -271 -6 -352 5 -577 80 -209 69 -350 159 -521 332 -145 147 -230 271 -347 510 -21 44 -43 88 -48 97 -11 22 -38 94 -49 133 -4 17 -18 55 -30 85 -12 30 -26 73 -30 95 -5 22 -18 76 -30 120 -48 177 -80 379 -62 396 17 18 217 22 452 9z"/></g></svg>',
    'thumbsup': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>',
    'thumbsdown': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path></svg>',
    'heart': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>',
    'question': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',
    'exclaim': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>',
    'laugh': '<svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>'
};
// Map old text reactions to new SVG keys for backwards compatibility
var REACTION_COMPAT_MAP = {
    '+1': 'thumbsup',
    '-1': 'thumbsdown',
    '♥': 'heart',
    '?': 'question',
    '!': 'exclaim',
    'XD': 'laugh'
};

// Get display SVG for a reaction (handles both old and new keys)
function getReactionSvg(reactionKey) {
    // If it's an old key, map to new
    var svgKey = REACTION_COMPAT_MAP[reactionKey] || reactionKey;
    return REACTION_SVGS[svgKey] || reactionKey; // Fallback to text if not found
}
